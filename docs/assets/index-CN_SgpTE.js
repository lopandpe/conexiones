(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();const i={1:{groupId:1,ids:["1","2","3","4"],texts:["Vinilo","Sol","Donut","Volante"],color:"#579c1e",title:"Cosas redondas",emoji:"üü©"},2:{groupId:2,ids:["5","6","7","8"],texts:["En","Un","Lugar","De"],color:"#1e559c",title:"Inicio de Don Quijote",emoji:"üü¶"},3:{groupId:3,ids:["9","10","11","12"],texts:["Para","Stop","Alto","Basta"],color:"#c230b6",title:"Qu√©date donde est√°s",emoji:"üü™"},4:{groupId:4,ids:["13","14","15","16"],texts:["Calculadora","Calendario","Navegador","Galer√≠a"],color:"#ecde14",title:"Aplicaciones de un smartphone",emoji:"üü®"}},L=new Date().toISOString().split("T")[0],y=`conexiones-${L}`,S="conexiones-stats",k=Object.assign({},{errorCount:0,statistic:[],todayResults:[],statsUpdated:!1,checks:0,final:!1,placedGroups:[]},JSON.parse(localStorage.getItem(y)||"{}"));let a=k;const v={totalDays:0,buckets:{0:0,1:0,2:0,3:0,fail:0},streak:0};let r=Object.assign({},v,JSON.parse(localStorage.getItem(S)||"{}"));function p(){localStorage.setItem(y,JSON.stringify(a))}function E(){localStorage.setItem(S,JSON.stringify(r))}let d=0;r.totalDays==0&&document.querySelector("#instructions").classList.toggle("active");document.querySelector("#open-modal").addEventListener("click",()=>{g("#modal")});document.querySelectorAll(".close-modal").forEach(t=>{t.addEventListener("click",()=>{const s=t.parentElement.parentElement.getAttribute("id");g(`#${s}`)})});x();setTimeout(()=>{T()},100);function x(){let t=[];for(const[l,e]of Object.entries(i))for(let n=0;n<4;n++)t.push({id:e.ids[n],text:e.texts[n],order:n});O(t);let o=1,s=1;t.forEach(l=>{s==5&&(o++,s=1);let e=document.createElement("div");e.classList.add("cell"),e.classList.add("row-"+o),e.classList.add("col-"+s),e.innerText=l.text,e.setAttribute("data-id",l.id),e.setAttribute("data-order",l.order),document.getElementById("grid").appendChild(e),s++})}function T(){a.final?(a.checks=0,setTimeout(()=>b(),100)):(a.placedGroups.forEach((t,o)=>{const s=i[t];s&&m(s,o,0)}),document.querySelector("#messages").innerHTML="Selecciona cuatro casillas, tienes <b>"+(4-a.errorCount)+"</b> intentos.")}let q=document.querySelectorAll(".cell");q.forEach(t=>{t.addEventListener("click",function(){a.final||(this.classList.contains("active")?(this.classList.remove("active"),d--):d<4?(this.classList.add("active"),d++):f("Solo puedes seleccionar cuatro casillas"))})});let I=document.querySelector("#submit");I.addEventListener("click",function(){let t=[];if(d==4){let o=document.querySelectorAll(".cell.active"),s=null,l=0,e=!0;if(o.forEach(n=>{let c=n.getAttribute("data-id");s=C(c,i),t.push({id:c,text:n.innerText,emoji:s.emoji}),l==0?l=s.groupId:s&&s.groupId!=l&&(e=!1)}),a.todayResults.push(t),e)m(s,a.checks,a.checks*500),a.placedGroups.push(l),a.checks++,a.checks=a.checks,d=0;else{o.forEach(c=>{c.classList.add("error")}),setTimeout(()=>{o.forEach(c=>{c.classList.remove("error")})},1e3),a.errorCount++;let n=document.querySelectorAll("#tries li:not(.explode)");n[n.length-1].classList.add("explode"),document.querySelector("#messages").innerHTML="Selecciona cuatro casillas, tienes <b>"+(4-a.errorCount)+"</b> intentos."}(a.errorCount>3||a.checks==4)&&(setTimeout(()=>{b(a.checks)},1e3),a.final=!0,a.final=!0,p())}else f("Debes seleccionar cuatro casillas","warning");p()});function f(t,o="warning",s=!1){let l=document.querySelector("#messages"),e=l.innerText;l.innerText=t,l.classList=[o],s||setTimeout(()=>{l.innerText=e,l.classList=[]},2e3)}function b(){f("Fin de la partida","warning",!0),document.querySelector("#actions").style.display="none",document.querySelector("#submit").style.pointerEvents="none";let t=1;for(const o in i){if(i.hasOwnProperty(o)){const s=i[o];m(s,a.checks++,t*1e3)}t++}a.statsUpdated||(A(),a.statsUpdated=!0,p()),setTimeout(()=>{w()},(t+2)*1e3)}function C(t,o){const s=t.toString();for(const[l,e]of Object.entries(o))if(e.ids.includes(s))return e;return null}function O(t){for(var o=t.length-1;o>0;o--){var s=Math.floor(Math.random()*(o+1)),l=t[o];t[o]=t[s],t[s]=l}}function j(t,o){let s=document.createElement("div");s.classList.add("solution-line");let l=document.createElement("div");l.classList.add("title"),l.innerText=t.title;let e=document.createElement("ul");t.texts.forEach(n=>{let c=document.createElement("li");c.innerText=n,e.appendChild(c)}),s.appendChild(l),s.appendChild(e),s.style.top=o*85+"px",document.getElementById("grid").appendChild(s),s.style.backgroundColor=t.color,setTimeout(()=>{s.style.opacity=1},1)}function m(t,o,s){console.log(t),console.log(o);for(let l=0;l<t.ids.length;l++){let e=document.querySelector("[data-id='"+t.ids[l]+"']");console.log(e),e.classList.remove("active");let n=o+1,c=l+1;console.log(".cell.row-"+n+".col-"+c);let u=document.querySelector(".cell.row-"+n+".col-"+c);u.classList=e.classList,e.classList=["cell row-"+n+" col-"+c],e.classList.add("checked"),e.style.backgroundColor=t.color}setTimeout(()=>{j(t,o)},s),delete i[t.groupId]}function w(){let t="";a.todayResults.forEach(c=>{let u=document.createElement("div");c.forEach(h=>{u.innerText+=h.emoji,t+=h.emoji}),t+="%0a",document.querySelector("#results").append(u)});var o=encodeURIComponent(location.href);let s="whatsapp://send?text=¬°Vaya juegazo!%0a"+t+"%0aJuega aqu√≠: "+o;document.querySelector("#whatsapp").setAttribute("href",s),document.querySelector("#open-modal").style.display="block";const l=document.querySelector("#fullstats"),e=c=>(c/r.totalDays*100).toFixed(1)+"%",n=`
        <h2>Estad√≠sticas hist√≥ricas</h2>
        <ul id="stats">
            <li><span>Sin fallos:</span> <span>${r.buckets[0]} (${e(r.buckets[0])})</span></li>
            <li><span>1 fallo:</span> <span>${r.buckets[1]} (${e(r.buckets[1])})</span></li>
            <li><span>2 fallos:</span> <span>${r.buckets[2]} (${e(r.buckets[2])})</span></li>
            <li><span>3 fallos:</span> <span>${r.buckets[3]} (${e(r.buckets[3])})</span></li>
            <li><span>No resuelto:</span> <span>${r.buckets.fail} (${e(r.buckets.fail)})</span></li>
        </ul>
        <p>Racha actual ganando: <b>${r.streak}</b> d√≠as</p>
    `;l.insertAdjacentHTML("beforeend",n),g("#modal")}function g(t){document.querySelector(t).classList.toggle("active")}function A(){r.totalDays++;const t=a.errorCount;t>=0&&t<=3?(r.buckets[t]++,r.streak++):(r.buckets.fail++,r.streak=0),E()}
