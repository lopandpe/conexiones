(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(e){if(e.ep)return;e.ep=!0;const a=s(e);fetch(e.href,a)}})();const i={1:{groupId:1,ids:["1","2","3","4"],texts:["Tel√©fono","Bol√≠grafo","Cubilete","Ordenador"],color:"#579c1e",title:"En la mesa de oficina",emoji:"üü©"},2:{groupId:2,ids:["5","6","7","8"],texts:["Llamada","Silbo canario","Humo","Gritos"],color:"#1e559c",title:"Formas de comunicarse",emoji:"üü¶"},3:{groupId:3,ids:["9","10","11","12"],texts:["Soledad","Rosas","Par√≠s","La playa"],color:"#c230b6",title:"Canciones de la Oreja de Van Gogh",emoji:"üü™"},4:{groupId:4,ids:["13","14","15","16"],texts:["Oso","Reconocer","Salas","Yo soy"],color:"#ecde14",title:"Pal√≠ndromos",emoji:"üü®"}},L=new Date().toISOString().split("T")[0],y=`conexiones-${L}`,S="conexiones-stats",k=Object.assign({},{errorCount:0,statistic:[],todayResults:[],statsUpdated:!1,checks:0,final:!1,placedGroups:[]},JSON.parse(localStorage.getItem(y)||"{}"));let r=k;const v={totalDays:0,buckets:{0:0,1:0,2:0,3:0,fail:0},streak:0};let n=Object.assign({},v,JSON.parse(localStorage.getItem(S)||"{}"));function f(){localStorage.setItem(y,JSON.stringify(r))}function E(){localStorage.setItem(S,JSON.stringify(n))}let d=0;document.querySelector("#open-modal").addEventListener("click",()=>{g()});document.querySelector("#close-modal").addEventListener("click",()=>{g()});x();setTimeout(()=>{T()},100);function x(){let t=[];for(const[l,e]of Object.entries(i))for(let a=0;a<4;a++)t.push({id:e.ids[a],text:e.texts[a],order:a});C(t);let o=1,s=1;t.forEach(l=>{s==5&&(o++,s=1);let e=document.createElement("div");e.classList.add("cell"),e.classList.add("row-"+o),e.classList.add("col-"+s),e.innerText=l.text,e.setAttribute("data-id",l.id),e.setAttribute("data-order",l.order),document.getElementById("grid").appendChild(e),s++})}function T(){r.placedGroups.forEach((t,o)=>{const s=i[t];s&&m(s,o,0)}),document.querySelector("#messages").innerHTML="Selecciona cuatro casillas, tienes <b>"+(4-r.errorCount)+"</b> intentos.",r.final&&setTimeout(()=>b(r.checks),100)}let q=document.querySelectorAll(".cell");q.forEach(t=>{t.addEventListener("click",function(){r.final||(this.classList.contains("active")?(this.classList.remove("active"),d--):d<4?(this.classList.add("active"),d++):p("Solo puedes seleccionar cuatro casillas"))})});let I=document.querySelector("#submit");I.addEventListener("click",function(){let t=[];if(d==4){let o=document.querySelectorAll(".cell.active"),s=null,l=0,e=!0;if(o.forEach(a=>{let c=a.getAttribute("data-id");s=O(c,i),t.push({id:c,text:a.innerText,emoji:s.emoji}),l==0?l=s.groupId:s&&s.groupId!=l&&(e=!1)}),r.todayResults.push(t),e)m(s,r.checks,r.checks*500),r.placedGroups.push(l),r.checks++,r.checks=r.checks,d=0;else{o.forEach(c=>{c.classList.add("error")}),setTimeout(()=>{o.forEach(c=>{c.classList.remove("error")})},1e3),r.errorCount++;let a=document.querySelectorAll("#tries li:not(.explode)");a[a.length-1].classList.add("explode"),document.querySelector("#messages").innerHTML="Selecciona cuatro casillas, tienes <b>"+(4-r.errorCount)+"</b> intentos."}(r.errorCount>3||r.checks==4)&&(p("Fin de la partida","warning",!0),setTimeout(()=>{b(r.checks)},1e3),r.final=!0,r.final=!0,f())}else p("Debes seleccionar cuatro casillas","warning");f()});function p(t,o="warning",s=!1){let l=document.querySelector("#messages"),e=l.innerText;l.innerText=t,l.classList=[o],s||setTimeout(()=>{l.innerText=e,l.classList=[]},2e3)}function b(){document.querySelector("#actions").style.display="none",document.querySelector("#submit").style.pointerEvents="none";let t=1;for(const o in i){if(i.hasOwnProperty(o)){const s=i[o];m(s,r.checks++,t*1e3)}t++}r.statsUpdated||($(),r.statsUpdated=!0,f()),setTimeout(()=>{w()},(t+2)*1e3)}function O(t,o){const s=t.toString();for(const[l,e]of Object.entries(o))if(e.ids.includes(s))return e;return null}function C(t){for(var o=t.length-1;o>0;o--){var s=Math.floor(Math.random()*(o+1)),l=t[o];t[o]=t[s],t[s]=l}}function j(t,o){let s=document.createElement("div");s.classList.add("solution-line");let l=document.createElement("div");l.classList.add("title"),l.innerText=t.title;let e=document.createElement("ul");t.texts.forEach(a=>{let c=document.createElement("li");c.innerText=a,e.appendChild(c)}),s.appendChild(l),s.appendChild(e),s.style.top=o*85+"px",document.getElementById("grid").appendChild(s),s.style.backgroundColor=t.color,setTimeout(()=>{s.style.opacity=1},1)}function m(t,o,s){for(let l=0;l<t.ids.length;l++){let e=document.querySelector("[data-id='"+t.ids[l]+"']");e.classList.remove("active");let a=o+1,c=l+1,u=document.querySelector(".cell.row-"+a+".col-"+c);u.classList=e.classList,e.classList=["cell row-"+a+" col-"+c],e.classList.add("checked"),e.style.backgroundColor=t.color}setTimeout(()=>{j(t,o)},s),delete i[t.groupId]}function w(){let t="";r.todayResults.forEach(c=>{let u=document.createElement("div");c.forEach(h=>{u.innerText+=h.emoji,t+=h.emoji}),t+="%0a",document.querySelector("#results").prepend(u)});var o=encodeURIComponent(location.href);let s="whatsapp://send?text=¬°Vaya juegazo!%0a"+t+"%0aJuega aqu√≠: "+o;document.querySelector("#whatsapp").setAttribute("href",s),document.querySelector("#open-modal").style.display="block";const l=document.querySelector("#fullstats"),e=c=>(c/n.totalDays*100).toFixed(1)+"%",a=`
        <h2>Estad√≠sticas hist√≥ricas</h2>
        <ul id="stats">
            <li><span>Sin fallos:</span> <span>${n.buckets[0]} (${e(n.buckets[0])})</span></li>
            <li><span>1 fallo:</span> <span>${n.buckets[1]} (${e(n.buckets[1])})</span></li>
            <li><span>2 fallos:</span> <span>${n.buckets[2]} (${e(n.buckets[2])})</span></li>
            <li><span>3 fallos:</span> <span>${n.buckets[3]} (${e(n.buckets[3])})</span></li>
            <li><span>No resuelto:</span> <span>${n.buckets.fail} (${e(n.buckets.fail)})</span></li>
        </ul>
        <p>Racha actual ganando: <b>${n.streak}</b> d√≠as</p>
    `;l.insertAdjacentHTML("beforeend",a),g()}function g(){document.querySelector("#modal").classList.toggle("active")}function $(){n.totalDays++;const t=r.errorCount;t>=0&&t<=3?(n.buckets[t]++,n.streak++):(n.buckets.fail++,n.streak=0),E()}
